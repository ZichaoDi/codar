\documentclass[xcolor=dvipsnames]{beamer}

\usepackage{etex}

\include{header}
\include{headerLocal}

\usepackage{tikz,pgfplots,pgfplotstable}
%\usepackage{epsf,amsmath,amssymb,amsfonts}
\usepackage{movie15}
\usepackage{graphicx}
\usepackage{epsfig}
\usepackage{float}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{hyperref}
\usepackage{comment}
\usepackage{color, colortbl}
\definecolor{LRed}{rgb}{1,.8,.8}
\usepackage{rotate}
\usepackage{BeamerColor}
\usepackage{paralist}
\usepackage{algorithmicx,algpseudocode}
\include{wendy_macros}
\graphicspath{{./images/}}
\usebackgroundtemplate{\includegraphics[width=\paperwidth]{NormalANLBlue}}

\setbeamercolor{block title}{bg=LightSteelBlue,fg=blue}  % bg=background, fg= foreground
\setbeamercolor{block body}{bg=azure1,fg=black}          % bg=background, fg= foreground
\setbeamercolor{alerted text}{fg=white,bg=red}
\newcommand{\boxalert}[1]{{%
  \usebeamercolor{alerted text}\colorbox{bg}{\alert{#1}}%
}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\hypersetup{%
  pdftitle={Optimization Approach for Tomographic Inversion from Multiple Data Modalities},%
  colorlinks=true,
  linkcolor=Blue,
  urlcolor=Red }

% -- TITLE PAGE --
\title{Accelerating Halo Center Finding }
\author{Zichao (Wendy) Di, Salman Habib, Steve Rangel, and Stefan Wild}
%\subtitle[AMS]{GMU Applied Math Seminar}
\institute[Argonne]{Mathematics \& Computer Science Division\\ Argonne National Laboratory}
\date{}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ... Title Page
\setbeamertemplate{footline}{}
{
  \usebackgroundtemplate{\includegraphics[width=\paperwidth]{TitleANLBlue}}
  \frame{\titlepage}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setbeamertemplate{footline}[frame number]{}

% ========================================
% FRAME: overview
% ========================================
 \begin{frame}
   \frametitle{Outline}
   \tableofcontents
 \end{frame}

% ========================================
% main slides come here
% ========================================

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction of Halo}
%  \begin{frame}
%    \frametitle{Outline}
%    % \tableofcontents[currentsection]
%  \end{frame}

\frame{
\frametitle{Halo Analysis}
\begin{itemize}
  \item An important and time-consuming analysis in halo analysis is to find halos and the centers of those halos.
  \item The friend-of-friends (FOF) halo: particles are ``linked`` together if their distance is smaller than a given threshold, called ''linking length``. 
  \item FOF halos do not intersect, meaning that a particle can be assigned uniquely to just one FOF halo. 
  \item substructure defined by smaller linking length lies completely in the host halo. 
\end{itemize}
}

\frame{
\frametitle{Illustration}
\begin{columns}
\column{2.5in}
\begin{figure}[H]
\includegraphics[scale=0.45]{FOFgroups-bridge-nointersect.png}
\caption{FOF halos can not intersect, if two halos are close enough, they are combined as one}
\end{figure}
\column{2.5in}
\begin{figure}[H]
\centering
    \includegraphics[scale=0.45]{FOFgroups-sub-linklength.png}
     \caption{FOF halos with different linking lengths (yellow, orange, violet)}
\end{figure}
\end{columns}
}

\frame{
\frametitle{Halo Centers}
\begin{itemize}
\item Most connected particle (MCP) center: the aprticle within a halo with the most ``friends''.
\item Most bound particle (MBP) center: the particle within a halo with the lowest potential, where the potential for a given particle is computed as the sum over all other particles of the negative of mass divided by distance.
 $$ MBP=\min_i \ds\sum_{j\neq i}\frac{-m_j}{d(X_i,X_j)}$$
 where $X_i$ is the $i$-th particle, $m_i$ is its corresponding mass, and $d(X_i,X_j)$ is the Euclidean distance between particles $X_i$ and $X_j$. 
\end{itemize}
}

\frame{
\frametitle{Illustration}
\begin{figure}[H]
\centering
    \includegraphics[scale=0.7]{MBP_MCP.png}
    \caption{Illustration of MBP and MCP on halos}
\end{figure}
}

\section{Finding MBP}
\frame{
\frametitle{Existing Approaches}
\begin{itemize}
\item Common practice: brute force which ends in $O(N_p^2)$ complexity where $N_p$ is the total number of particles in a targeted halo.
\item Our goal: accelerate the process of MBP finding by recursive method.
\end{itemize}
\begin{figure}[H]
\includegraphics[scale=0.5]{naive.eps}
\end{figure}
}

\frame{
\frametitle{Proposed Recursive Method}
{\footnotesize
\begin{algorithmic}[]
\Procedure {$MBP=recursive\_localMBP(X,m)$}{}
\State{tree=kdtree(X).}
\State {\bf If $(level=1)$}
\State Select uniformaly distributed random indices $\tilde{i}$ from $[1,\dots,N_p]$ as $Seeds$.
\State For each $\tilde{i}$, $IDX=rangesearch(tree,X_{\tilde{i}},\varepsilon)$, where $\varepsilon$ is the neiborhood radius provided for tree search, and $IDX$ is the index function to indicate which particles are friends of $X_{\tilde{i}}$. Calculate $\tilde{BP}_{\tilde{i}}=\ds\sum_{\{j|IDX\neq j\}}\frac{-m_j}{d(X_{\tilde{i}},X_j)}$, where $\tilde{BP}$ denotes local bounded potential. 
\State Update $Seeds$ as local peaks of the $\tilde{BP}$ map, and find $\tilde{MBP}$ as the minimum of $\tilde{BP}$ map. 

\State {\bf Else}

\State for each $\tilde{i}$ in $Seeds$, calculate $IDX_{\tilde{i}}=rangesearch(tree,X_{\tilde{i}},\tilde{\varepsilon})$.

\State Calculate $\tilde{BP}$ for each particle in $IDX_{\tilde{i}}$ for each $\tilde{i}$.
\State Set $\tilde{MBP}_0=\tilde{MBP}$.
\State Find $\tilde{MBP}$ as the minimum of $\tilde{BP}$ map. 
\State if $\tilde{MBP}_0=\tilde{MBP}$, stop the procedure; else, $level=level+1$.
\EndProcedure
\end{algorithmic} 
}
}

\section{Numerical Results}
\frame{
\frametitle{Algorithm Illustration on 2D halo}
\begin{columns}
\column{1.2in}
\begin{figure}[H]
\includegraphics[scale=0.43]{2d_1}
\end{figure}
\column{1.2in}
\begin{figure}[H]
\centering
    \includegraphics[scale=0.43]{2d_2}
\end{figure}
\column{2.2in}
\begin{figure}[H]
\centering
    \includegraphics[scale=0.45]{2d_result}
\end{figure}
\end{columns}
}
\frame{
\frametitle{Results for 3D Halos}
\begin{columns}
\column{2.5in}
\begin{figure}[H]
\includegraphics[scale=0.5]{3d_timing}
\end{figure}
\column{2.5in}
\begin{figure}[H]
\centering
    \includegraphics[scale=0.5]{3d_error}
\end{figure}
\end{columns}
}
\section{Summary}
%  \begin{frame}
%    \frametitle{Outline}
%    \tableofcontents[currentsection]
%  \end{frame}

\frame{
\frametitle{Summary}
\begin{itemize}
  \item We propose a highly recursive algorithm to accelerate the process the halo MBP finding.
\vspace{12pt}
   \item Preliminary results show the potential of the proposed algorithm to reduce the complexity to $O(N_p \log N_p)$.
\vspace{12pt}
   \item There are still many components requiring rigorous analysis for optimal performance from both the mathematical and physical principles.
\vspace{12pt}
\end{itemize}
}
\frame{
\frametitle{Acknowledgement}
\begin{block}{}
This work was funded under the ECP codesign center ``Codar''. 
\end{block}
\vspace{12pt}

\begin{center}
\textcolor{red}{THANKS!}
\end{center}
}
\end{document}

